<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ordering and Clustering • NGCHMR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Ordering and Clustering">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NGCHMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Installation.html">Installation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/color-maps.html">Color Maps</a></li>
    <li><a class="dropdown-item" href="../articles/data-layers.html">Data Layers</a></li>
    <li><a class="dropdown-item" href="../articles/ordering-and-clustering.html">Ordering and Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/adding-linkouts.html">Adding Linkouts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-video-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Video Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-video-tutorials">
<li><a class="external-link dropdown-item" href="https://www.youtube.com/playlist?list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh">Playlist: NG-CHMs in R/R-Studio</a></li>
    <li><a class="external-link dropdown-item" href="https://www.youtube.com/watch?v=O42w5P3A1_8&amp;list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh">How to create NG-CHMs in R-Studio</a></li>
    <li><a class="external-link dropdown-item" href="https://www.youtube.com/watch?v=847breSor1I&amp;list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh">How to use any ordering method with NG-CHMs</a></li>
    <li><a class="external-link dropdown-item" href="https://www.youtube.com/watch?v=K8PuHDQYk-g&amp;list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh">How to create a single-cell NG-CHM in R</a></li>
    <li><a class="external-link dropdown-item" href="https://www.youtube.com/watch?v=iu0ptg9SBqM&amp;list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh">Run NG-CHM RStudio container in Windows 10 Docker Desktop</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MD-Anderson-Bioinformatics/NGCHM-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ordering and Clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MD-Anderson-Bioinformatics/NGCHM-R/blob/main/vignettes/ordering-and-clustering.Rmd" class="external-link"><code>vignettes/ordering-and-clustering.Rmd</code></a></small>
      <div class="d-none name"><code>ordering-and-clustering.Rmd</code></div>
    </div>

    
    
<p>This vignette describes options for ordering rows and columns of an
NG-CHM, and the additional options available when the ordering is
hierarchical clustering. The YouTube video <a href="https://www.youtube.com/watch?v=847breSor1I&amp;list=PLIBaINv-Qmd0v2qD4AMbGf85Xd-T_yzEh" class="external-link">How
to Use Any Label Order or Clustering Method with NG-CHMs</a>, also
covers these topics.</p>
<p>These examples build on the setup from <a href="getting-started.html">Getting Started</a>.</p>
<div class="section level2">
<h2 id="specifying-row-column-order">Specifying Row / Column Order<a class="anchor" aria-label="anchor" href="#specifying-row-column-order"></a>
</h2>
<p>The function <code><a href="../reference/chmNew.html">chmNew()</a></code> has optional arguments “rowOrder”
and “colOrder” to specify the order of the rows and columns,
respectively. Values for these arguments can be a vector, dendrogram, or
function specifying the order of the rows/columns.</p>
<p>For example, the following code block creates an NG-CHM with rows
sorted alphabetically and columns ordered randomly:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rowOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chmNew.html">chmNew</a></span><span class="op">(</span><span class="st">"tcga-brca"</span>, <span class="va">matrix_data</span>, rowOrder <span class="op">=</span> <span class="va">rowOrder</span>, colOrder <span class="op">=</span> <span class="va">colOrder</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hierarchical-clustering-options">Hierarchical Clustering Options<a class="anchor" aria-label="anchor" href="#hierarchical-clustering-options"></a>
</h2>
<p>For hierarchical clustering, additional options are available to
specify the distance measure and clustering method.</p>
<p>The arguments to <code><a href="../reference/chmNew.html">chmNew()</a></code> ‘rowDist’ and ‘colDist’
specify the distance measure for rows and columns, respectively. The
available choices include those of the <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code>
function, as well as two additional distance metric options: ‘cosine’
and ‘correlation’. The default choice is ‘correlation’, which computes
the distance measure as 1 minus the Pearson correlation among the
rows/columns.</p>
<p>Arguments ‘rowAgglom’ and ‘colAgglom’ specify the clustering method,
and the available options are those of the <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code>
function. The default is ‘ward.D2’.</p>
<p>This example specifies an NG-CHM with hierarchical clustering using
the Euclidean distance metric and complete linkage clustering algorithm
for both rows and columns:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chmNew.html">chmNew</a></span><span class="op">(</span><span class="st">"tcga-brca"</span>, <span class="va">matrix_data</span>, rowDist <span class="op">=</span> <span class="st">"euclidean"</span>, colDist <span class="op">=</span> <span class="st">"euclidean"</span>, rowAgglom <span class="op">=</span> <span class="st">"complete"</span>, colAgglom <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span></span></code></pre></div>
<p><a href="#">Back to top</a></p>
</div>
<div class="section level2">
<h2 id="explicit-clustering">Explicit Clustering<a class="anchor" aria-label="anchor" href="#explicit-clustering"></a>
</h2>
<p>Clustering may be performed explicitly (e.g. via
<code>stats::hclust())</code> and used in constructing an NG-CHM. The
following creates an object of class hclust from the distance matrix of
the demo expression data, for both the rows and columns, and uses those
clustering results to construct an NG-CHM.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rowClust</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colClust</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chmNew.html">chmNew</a></span><span class="op">(</span><span class="st">"tcga-brca"</span>, <span class="va">matrix_data</span>, rowOrder <span class="op">=</span> <span class="va">rowClust</span>, colOrder <span class="op">=</span> <span class="va">colClust</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, an hclust object can be transformed into a dendrogram and
used for the row and/or column ordering. The example below uses the
clustering results from above as dendrograms:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rowDendrogram</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colDendrogram</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chmNew.html">chmNew</a></span><span class="op">(</span><span class="st">"tcga-brca"</span>, <span class="va">matrix_data</span>, rowOrder <span class="op">=</span> <span class="va">rowDendrogram</span>, colOrder <span class="op">=</span> <span class="va">colDendrogram</span><span class="op">)</span></span></code></pre></div>
<p><a href="#">Back to top</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley M Broom, Mary A Rohrdanz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>



  <script> /* open external links in new tab */ (function() { for (const link of document.getElementsByTagName('a')) { if (link.classList.contains('external-link')) link.target = '_blank'; } })(); </script>
</body>
</html>
